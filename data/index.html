<script>
  function richiediDati() {
    fetch('bms_data.json')
      .then(response => response.json())
      .then(data => {
        // Visualizza i dati sul client
        document.getElementById('tempb1').innerText = data.tbms[0] +" C";
        document.getElementById('tempb2').innerText = data.tbms[1] +" C";
        document.getElementById('tempb3').innerText = data.tbms[2] +" C";
        document.getElementById('current').innerText = data.current + " A";
        document.getElementById('vtot').innerText = data.vtot + " V";
        document.getElementById('power').innerText = data.power + " W";
        document.getElementById('energy').innerText = data.energy + " kWh";
	for (let i=0 ; i<24 ; i++ ) {
		innername="vbat"+(i+1);
        	document.getElementById(innername).innerText = data.vcell[i];
	}


      })
      .catch(error => console.error('Errore:', error));
  }

  // Esegui la funzione richiediDati quando la pagina è pronta
//  document.addEventListener('DOMContentLoaded', richiediDati);
  setInterval(richiediDati, 1000);
</script>


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabella</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
            position: relative;
        }
        th {
            background-color: #f2f2f2;
        }
        .numeratore {
            position: absolute;
            left: 0;
            top: 0;
            font-size: 10px;
        }
        .valore {
            font-size: 14px;
        }
    </style>
</head>
<body>

<div>
  <p>Battery Voltage: <span id="vtot"></span></p>
  <p>Current: <span id="current"></span></p>
  <p>Power: <span id="power"></span></p>
  <p>Energy: <span id="energy"></span></p>
</div>

<table>
    <thead>

        <tr>
            <th colspan="3">Cells Status</th>
        </tr>
        <tr>
            <th>Group 1</th>
            <th>Group 2</th>
            <th>Group 3</th>
        </tr>
    </thead>
    <tbody>
        <!-- Per le prime due colonne -->
        <tr>
            <td>
                <div class="numeratore">temp</div>
                <div class="valore" contenteditable="true" id="tempb1">10 °C</div>
            </td>
            <td>
                <div class="numeratore">temp</div>
                <div class="valore" contenteditable="true" id="tempb2">11 °C</div>
            </td>
            <td>
                <div class="numeratore">temp</div>
                <div class="valore" contenteditable="true" id="tempb3">12 °C</div>
            </td>
        </tr>
        <tr>
            <td>
                <div class="numeratore">1</div>
                <div class="valore" contenteditable="true" id="vbat1">Valore 1</div>
            </td>
            <td>
                <div class="numeratore">8</div>
                <div class="valore" contenteditable="true" id="vbat8">Valore 8</div>
            </td>
            <td>
                <div class="numeratore">15</div>
                <div class="valore" contenteditable="true" id="vbat15">Valore 15</div>
            </td>
        </tr>
        <tr>
            <td>
                <div class="numeratore">2</div>
                <div class="valore" contenteditable="true" id="vbat2">Valore 2</div>
            </td>
            <td>
                <div class="numeratore">9</div>
                <div class="valore" contenteditable="true" id="vbat9">Valore 9</div>
            </td>
            <td>
                <div class="numeratore">16</div>
                <div class="valore" contenteditable="true" id="vbat16">Valore 16</div>
            </td>
        </tr>
        <tr>
            <td>
                <div class="numeratore">3</div>
                <div class="valore" contenteditable="true" id="vbat3">Valore 3</div>
            </td>
            <td>
                <div class="numeratore">10</div>
                <div class="valore" contenteditable="true" id="vbat10">Valore 10</div>
            </td>
            <td>
                <div class="numeratore">17</div>
                <div class="valore" contenteditable="true" id="vbat17">Valore 17</div>
            </td>
        </tr>
        <tr>
            <td>
                <div class="numeratore">4</div>
                <div class="valore" contenteditable="true" id="vbat4">Valore 4</div>
            </td>
            <td>
                <div class="numeratore">11</div>
                <div class="valore" contenteditable="true" id="vbat11">Valore 11</div>
            </td>
            <td>
                <div class="numeratore">18</div>
                <div class="valore" contenteditable="true" id="vbat18">Valore 18</div>
            </td>
        </tr>
        <tr>
            <td>
                <div class="numeratore">5</div>
                <div class="valore" contenteditable="true" id="vbat5">Valore 5</div>
            </td>
            <td>
                <div class="numeratore">12</div>
                <div class="valore" contenteditable="true" id="vbat12">Valore 12</div>
            </td>
            <td>
                <div class="numeratore">19</div>
                <div class="valore" contenteditable="true" id="vbat19">Valore 19</div>
            </td>
        </tr>
        <tr>
            <td>
                <div class="numeratore">6</div>
                <div class="valore" contenteditable="true" id="vbat6">Valore 6</div>
            </td>
            <td>
                <div class="numeratore">13</div>
                <div class="valore" contenteditable="true" id="vbat13">Valore 13</div>
            </td>
            <td>
                <div class="numeratore">20</div>
                <div class="valore" contenteditable="true" id="vbat20">Valore 20</div>
            </td>
        </tr>
        <tr>
            <td>
                <div class="numeratore">7</div>
                <div class="valore" contenteditable="true" id="vbat7">Valore 7</div>
            </td>
            <td>
                <div class="numeratore">14</div>
                <div class="valore" contenteditable="true" id="vbat14">Valore 14</div>
            </td>
            <td>
                <div class="numeratore">21</div>
                <div class="valore" contenteditable="true" id="vbat21">Valore 21</div>
            </td>
        </tr>
        <!-- Per la terza colonna -->
        <tr>
            <td colspan="2"></td>
            <td>
                <div class="numeratore">22</div>
                <div class="valore" contenteditable="true" id="vbat22">Valore 22</div>
            </td>
        </tr>
        <tr>
            <td colspan="2"></td>
            <td>
                <div class="numeratore">23</div>
                <div class="valore" contenteditable="true" id="vbat23">Valore 23</div>
            </td>
        </tr>
        <tr>
            <td colspan="2"></td>
            <td>
                <div class="numeratore">24</div>
                <div class="valore" contenteditable="true" id="vbat24">Valore 24</div>
            </td>
        </tr>
    </tbody>
</table>

</body>
</html>

